# OmniAlpha: å…¨åœºæ™¯æ™ºèƒ½é‡åŒ–ç ”ç©¶ä¸äº¤æ˜“å¼•æ“

**OmniAlpha** æ˜¯ä¸€ä¸ªä¸“ä¸º A è‚¡å¸‚åœºè®¾è®¡çš„æ¨¡å—åŒ–é‡åŒ–äº¤æ˜“å¹³å°ã€‚å®ƒä¸ä»…é›†æˆäº†å®æ—¶è¡Œæƒ…è·å–ã€å†å²å›æµ‹å’Œæ¨¡æ‹Ÿç›˜æ‰§è¡Œï¼Œæ›´æ ¸å¿ƒçš„çªç ´åœ¨äºå…¶**åŒå¾ªç¯æ¶æ„**ï¼šå†…ç½®åŸºäºé—ä¼ ç®—æ³•ä¸å¼ºåŒ–å­¦ä¹ çš„ **AlphaGen å› å­æŒ–æ˜å·¥å‚**ï¼Œå¹¶é¢„ç•™äº† **LLMï¼ˆå¤§è¯­è¨€æ¨¡å‹ï¼‰** æ¥å£ï¼Œç”¨äºè¯­ä¹‰æƒ…æ„Ÿåˆ†æä¸ç­–ç•¥è‡ªåŠ¨åŒ–ç”Ÿæˆã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

*   **ğŸ–¥ï¸ å¯è§†åŒ–å·¥ä½œå°**: åŸºäº Streamlit æ‰“é€ çš„äº¤äº’å¼ Web ç•Œé¢ï¼Œæ”¯æŒå¤§ç›˜ç›‘æ§ã€ç­–ç•¥ç»„åˆé€‰è‚¡ã€ç»“æœå¯è§†åŒ–åˆ†æã€‚
*   **ğŸ› ï¸ æ¨¡å—åŒ–æ¶æ„**: é‡‡ç”¨ä¾èµ–å€’ç½®è®¾è®¡ï¼ŒData Providerã€Strategyã€Engine é«˜åº¦è§£è€¦ï¼Œæ–¹ä¾¿æ‰©å±•ã€‚
*   **ğŸ“ˆ å¤šç»´åº¦ç­–ç•¥**: å†…ç½®å‡çº¿è¶‹åŠ¿ã€æ”¾é‡çªç ´ã€ä½ä¼°å€¼ã€é«˜æ¢æ‰‹ç­‰å¤šç§å®æˆ˜ç­–ç•¥ï¼Œæ”¯æŒè‡ªç”±ç»„åˆã€‚
*   **ğŸ” æ·±åº¦ä¸ªè‚¡è¯Šæ–­**: è‡ªåŠ¨è®¡ç®— MA5/20/60ã€RSI ç­‰æŒ‡æ ‡ï¼Œæä¾›é‡ä»·æ—¶ç©ºå…¨æ–¹ä½å›¾è¡¨åˆ†æã€‚

## ğŸ“š ç­–ç•¥åº“ (Strategy Library)

### æŠ€æœ¯é¢ç­–ç•¥ (Technical)
*   **`ma` (å‡çº¿è¶‹åŠ¿)**: æ•æ‰ä¸Šå‡é€šé“ä¸ªè‚¡ (Close > MA20 & MA5 > MA20)ã€‚
*   **`vol` (æ”¾é‡çªç ´)**: å¯»æ‰¾èµ„é‡‘å¼‚åŠ¨ (æ¶¨å¹… > 2% & é‡æ¯” > 1.5)ã€‚
*   **`turn` (é«˜æ¢æ‰‹)**: ç­›é€‰å¸‚åœºæ´»è·ƒæ ‡çš„ (æ¢æ‰‹ç‡ > 5% & éST)ã€‚

### åŸºæœ¬é¢ç­–ç•¥ (Fundamental)
*   **`pe` (ä½ä¼°å€¼)**: å¯»æ‰¾å®‰å…¨è¾¹é™… (0 < PE-TTM < 30)ã€‚
*   **`growth` (åŒé«˜å¢é•¿)**: æŒ–æ˜é«˜æˆé•¿æ½œåŠ› (å‡€åˆ©æ¶¦åŒæ¯” > 20%)ã€‚
*   **`roe` (é«˜ROE)**: é”å®šä¼˜è´¨èµ„äº§ (ROE > 15%)ã€‚
*   **`debt` (ä½è´Ÿå€º)**: è§„é¿è´¢åŠ¡é£é™© (èµ„äº§è´Ÿå€ºç‡ < 50%)ã€‚

---

## ğŸ“‚ é¡¹ç›®ç»“æ„ (Project Structure)

*(Updated: 2026-01-08)*

```text
BlackOil-OmniAlpha/
â”œâ”€â”€ web_ui.py               # ğŸŒ **Web é€‰è‚¡å·¥ä½œå°**: åŸºäº Streamlit çš„äº¤äº’å¼ç•Œé¢ï¼Œç”¨äºæ‰§è¡Œç­–ç•¥æ‰«æå’Œå¯è§†åŒ–åˆ†æã€‚
â”œâ”€â”€ main.py                 # ğŸš€ **ä¸»ç¨‹åºå…¥å£**: ç”¨äºæ¼”ç¤ºå› å­è®¡ç®—ä¸å›æµ‹æµç¨‹çš„ CLI å…¥å£ã€‚
â”œâ”€â”€ stock_selector.py       # ğŸ›  **CLI é€‰è‚¡å·¥å…·**: å‘½ä»¤è¡Œç‰ˆæœ¬çš„é€‰è‚¡å™¨ (Legacy)ã€‚
â”œâ”€â”€ core/                   # ğŸ§  **æ ¸å¿ƒç»„ä»¶å±‚ (Core Layer)**
â”‚   â”œâ”€â”€ config.py           #    å…¨å±€é…ç½®ï¼šå®šä¹‰è·¯å¾„ã€å¸¸é‡ã€‚
â”‚   â”œâ”€â”€ engine.py           #    **æ‰«æå¼•æ“ (AnalysisEngine)**: ä¸“ä¸º Web UI è®¾è®¡çš„æ‰¹é‡é€‰è‚¡æ‰«æå™¨ã€‚
â”‚   â””â”€â”€ strategies_registry.py # **ç­–ç•¥æ³¨å†Œè¡¨**: ç»Ÿä¸€ç®¡ç†ç­–ç•¥ç±»çš„æ³¨å†Œä¸è·å–ï¼Œè§£å†³å¾ªç¯ä¾èµ–ã€‚
â”œâ”€â”€ data/                   # ğŸ’¾ **æ•°æ®æœåŠ¡å±‚ (Data Layer)**
â”‚   â”œâ”€â”€ baostock_provider.py # **æ•°æ®æä¾›è€…**: å°è£… Baostock APIï¼Œæä¾›ç»Ÿä¸€çš„è¡Œæƒ…ä¸è´¢æŠ¥æ•°æ®æ¥å£ã€‚
â”‚   â””â”€â”€ store/              #    æœ¬åœ°ç¼“å­˜ï¼šç”¨äºå­˜å‚¨ä¸‹è½½çš„ CSV/Parquet æ•°æ®ã€‚
â”œâ”€â”€ strategies/             # ğŸ“ˆ **ç­–ç•¥å®ç°å±‚ (Strategy Layer)**
â”‚   â”œâ”€â”€ base.py             #    ç­–ç•¥åŸºç±»ï¼šå®šä¹‰ `StockStrategy` æ¥å£ã€‚
â”‚   â”œâ”€â”€ technical.py        #    æŠ€æœ¯é¢ç­–ç•¥ï¼šMAå‡çº¿ã€æ”¾é‡çªç ´ã€é«˜æ¢æ‰‹ç­‰ã€‚
â”‚   â”œâ”€â”€ fundamental.py      #    åŸºæœ¬é¢ç­–ç•¥ï¼šä½PEã€é«˜æˆé•¿ã€é«˜ROEã€ä½è´Ÿå€ºç­‰ã€‚
â”‚   â””â”€â”€ __init__.py         #    åŒ…åˆå§‹åŒ–ã€‚
â”œâ”€â”€ alpha/                  # ğŸ§¬ **å› å­æŒ–æ˜å±‚ (Alpha Layer)**
â”‚   â”œâ”€â”€ factors/            #    å› å­åº“ï¼šåŒ…å« GTJA191 ç­‰ç»å…¸å› å­è®¡ç®—é€»è¾‘ã€‚
â”‚   â””â”€â”€ mining/             #    æŒ–æ˜å¼•æ“ï¼šåŸºäºé—ä¼ ç®—æ³•çš„å› å­æŒ–æ˜æ¡†æ¶ (é¢„ç•™)ã€‚
â”œâ”€â”€ backtest/               # ğŸ”™ **å›æµ‹å¼•æ“å±‚ (Backtest Layer)**
â”‚   â””â”€â”€ engine.py           #    **äº‹ä»¶é©±åŠ¨å¼•æ“**: ç”¨äºå†å²æ•°æ®çš„å›æµ‹æ¨¡æ‹Ÿ (Event-Driven)ã€‚
â”œâ”€â”€ llm/                    # ğŸ¤– **å¤§æ¨¡å‹äº¤äº’å±‚ (LLM Layer)**
â”‚   â””â”€â”€ interface.py        #    LLM æ¥å£ï¼šç”¨äºè§£æè‡ªç„¶è¯­è¨€æŒ‡ä»¤æˆ–ç”Ÿæˆç­–ç•¥ä»£ç ã€‚
â””â”€â”€ utils/                  # ğŸ”§ **å·¥å…·åº“**
    â”œâ”€â”€ date_utils.py       #    æ—¥æœŸå¤„ç†å·¥å…·ã€‚
    â””â”€â”€ file_io.py          #    æ–‡ä»¶è¯»å†™è¾…åŠ©ã€‚
```

## ğŸ—ï¸ æ¨¡å—è¯¦è§£ (Module Details)

### 1. æ ¸å¿ƒä¸å·¥å…· (Core & Utils)
*   **`web_ui.py`**: é¡¹ç›®çš„å¯è§†åŒ–å‰ç«¯ã€‚è°ƒç”¨ `core.engine.AnalysisEngine` å¯¹è‚¡ç¥¨æ± è¿›è¡Œå®æ—¶æ‰«æï¼Œå¹¶ä½¿ç”¨ Altair ç»˜åˆ¶äº¤äº’å¼å›¾è¡¨ï¼ˆKçº¿ã€ä¼°å€¼åˆ†å¸ƒã€RSIç­‰ï¼‰ã€‚
*   **`core/engine.py`**: è½»é‡çº§**æ‰«æå¼•æ“**ã€‚ä¸åŒäºå›æµ‹å¼•æ“ï¼Œå®ƒä¸“æ³¨äºåœ¨â€œå½“å‰æ—¶é—´ç‚¹â€å¯¹å¤§é‡è‚¡ç¥¨è¿›è¡Œå¹¶è¡Œæˆ–ä¸²è¡Œçš„æ¡ä»¶è¿‡æ»¤ã€‚
*   **`core/strategies_registry.py`**: ç­–ç•¥å·¥å‚æ¨¡å¼çš„å®ç°ã€‚ä¸ºäº†è§£è€¦ `web_ui` å’Œ `strategies` å…·ä½“å®ç°ï¼Œé€šè¿‡æ³¨å†Œè¡¨æ¨¡å¼åŠ¨æ€è·å–ç­–ç•¥å®ä¾‹ã€‚

### 2. æ•°æ®å±‚ (Data)
*   **`data/baostock_provider.py`**: æ•°æ®æ¥å…¥å±‚ã€‚ç›®å‰ä¸»è¦å¯¹æ¥ **Baostock** å…è´¹æ•°æ®æºã€‚
    *   `get_daily_bars`: è·å–æ—¥çº¿è¡Œæƒ…ï¼ˆæ”¯æŒå¤æƒï¼‰ã€‚
    *   `get_profit_data` / `get_growth_data`: è·å–å­£é¢‘è´¢æŠ¥æ•°æ®ï¼ˆROEã€å‡€åˆ©å¢é•¿ç­‰ï¼‰ã€‚
    *   å®ç°äº†å•ä¾‹æ¨¡å¼ï¼Œè‡ªåŠ¨å¤„ç†ç™»å½•/ç™»å‡ºã€‚

### 3. ç­–ç•¥å±‚ (Strategies)
*   **`strategies/technical.py`**: åŒ…å«åŸºäºä»·é‡çš„æŠ€æœ¯åˆ†æç­–ç•¥ã€‚
    *   `MovingAverageStrategy`: å‡çº¿å¤šå¤´æ’åˆ—ã€‚
    *   `VolumeRiseStrategy`: é‡ä»·é½å‡ã€‚
*   **`strategies/fundamental.py`**: åŒ…å«åŸºäºè´¢æŠ¥çš„åŸºæœ¬é¢åˆ†æç­–ç•¥ã€‚
    *   æ™ºèƒ½æ¨æ–­å½“å‰æ—¥æœŸåº”æŸ¥è¯¢çš„è´¢æŠ¥å­£åº¦ï¼ˆå¦‚5æœˆæŸ¥ä¸€å­£æŠ¥ï¼Œ11æœˆæŸ¥ä¸‰å­£æŠ¥ï¼‰ã€‚
    *   `LowPeStrategy`, `HighRoeStrategy` ç­‰ã€‚

### 4. å› å­ä¸å›æµ‹ (Alpha & Backtest)
*   **`alpha/factors/gtja191.py`**: å¤ç°äº†å›½æ³°å›å®‰ 191 ä¸ªçŸ­å‘¨æœŸ Alpha å› å­ï¼Œåˆ©ç”¨ Pandas/Numpy è¿›è¡Œå‘é‡åŒ–è®¡ç®—ï¼Œä¸ºæœºå™¨å­¦ä¹ æŒ–æ˜æä¾›ç‰¹å¾åº“ã€‚
*   **`backtest/engine.py`**: **å›æµ‹å¼•æ“**ã€‚è¿™æ˜¯ä¸€ä¸ªæ—¶é—´é©±åŠ¨çš„ä»¿çœŸå™¨ï¼Œç”¨äºåœ¨å†å²æ•°æ®ä¸ŠéªŒè¯ç­–ç•¥çš„é•¿æœŸæœ‰æ•ˆæ€§ï¼Œè®¡ç®— Sharpeã€MaxDrawdown ç­‰æŒ‡æ ‡ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ (Quick Start)

### 1. ç¯å¢ƒå‡†å¤‡ (Prerequisites)
ç¡®ä¿æ‚¨çš„ç³»ç»Ÿå·²å®‰è£… **Python 3.8+**ã€‚

### 2. å®‰è£…ä¾èµ– (Install Dependencies)
å»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒç®¡ç†ä¾èµ–ï¼š
```bash
pip install -r requirements.txt
```

### 3. è¿è¡Œæ–°ç‰ˆæ¼”ç¤º (Run New Architecture)
ä½“éªŒå®Œæ•´çš„æ•°æ®-å› å­-å›æµ‹æµç¨‹ï¼ˆæ— éœ€ä»»ä½•å‚æ•°ï¼‰ï¼š
```bash
python main.py
```
*åŠŸèƒ½ï¼šè‡ªåŠ¨è·å– HS300 æˆåˆ†è‚¡æ•°æ® -> è®¡ç®— GTJA191 å› å­ -> æ‰§è¡ŒåŸºç¡€å›æµ‹æ¼”ç¤ºã€‚*

### 4. è¿è¡Œå¯è§†åŒ–å·¥ä½œå° (Legacy)
å¯åŠ¨åŸºäº Streamlit çš„ Web ç•Œé¢è¿›è¡Œé€‰è‚¡åˆ†æï¼ˆæ­£åœ¨é€‚é…æ–°æ¶æ„ï¼‰ï¼š
```bash
streamlit run web_ui.py
```

---

## ğŸ“… é¡¹ç›®è§„åˆ’ (Roadmap)

*   [x] **Phase 1**: æ ¸å¿ƒå¼•æ“é‡æ„ä¸æ¨¡å—åŒ– (Completed 2026-01-08)ã€‚
*   [x] **Phase 2**: å»ºç«‹ Data-Alpha-Backtest åˆ†å±‚æ¶æ„ (Completed 2026-01-08)ã€‚
*   [ ] **Phase 3**: å®Œå–„ `BacktestEngine`ï¼Œå®ç°çœŸå®çš„æ’®åˆé€»è¾‘ä¸ç»©æ•ˆç»Ÿè®¡ã€‚
*   [ ] **Phase 4**: å®ç° `GeneticMiner`ï¼Œè·‘é€šç¬¬ä¸€ä¸ªè‡ªåŠ¨æŒ–æ˜çš„ Alpha å› å­ã€‚
*   [ ] **Phase 5**: æ¥å…¥ LLMï¼Œå®ç° "Text-to-Strategy" è‡ªåŠ¨ä»£ç ç”Ÿæˆã€‚

---

## ğŸ¤ è´¡çŒ®ä¸åé¦ˆ

æ¬¢è¿æäº¤ Issue æˆ– Pull Requestï¼
*   **ç­–ç•¥è´¡çŒ®**: è¯·åœ¨ `strategies/` ç›®å½•ä¸‹æ·»åŠ æ–°çš„ç­–ç•¥ç±»ï¼Œå¹¶åœ¨ `__init__.py` ä¸­æ³¨å†Œã€‚
*   **Bug åé¦ˆ**: è¯·é™„ä¸Šè¯¦ç»†çš„æŠ¥é”™ä¿¡æ¯å’Œå¤ç°æ­¥éª¤ã€‚

---
